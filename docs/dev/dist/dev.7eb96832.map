{"version":3,"sources":["node_modules/fre/dist/fre.js","index.js"],"names":["DOWN_URL","QCODE","App","document","getElementById"],"mappings":"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","file":"dev.7eb96832.map","sourceRoot":"..","sourcesContent":["(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n  typeof define === 'function' && define.amd ? define(['exports'], factory) :\n  (global = global || self, factory(global.fre = {}));\n}(this, function (exports) { 'use strict';\n\n  const TEXT = 'text';\n\n  function h(tag, config, ...args) {\n    const props = Object.assign({}, config);\n    const hasChildren = args.length > 0;\n    const rawChildren = hasChildren ? [].concat(...args) : [];\n    props.children = rawChildren\n      .filter(c => c != null && c !== false)\n      .map(c => (c instanceof Object ? c : h(TEXT, { nodeValue: c })));\n    return { tag, props }\n  }\n\n  const isEvent = name => name.startsWith('on');\n  const isText = name => name === 'nodeValue';\n  const isAttribute = name => name === 'class' || name === 'id' || name === 'href' || name === 'target' || name === 'src';\n  const isNew = (prev, next) => key => prev[key] !== next[key];\n\n  function updateProperties(dom, prevProps, nextProps) {\n    Object.keys(nextProps)\n      .filter(isText)\n      .filter(isNew(prevProps, nextProps))\n      .forEach(name => {\n        dom[name] = nextProps[name];\n      });\n\n      Object.keys(nextProps)\n      .filter(isAttribute)\n      .filter(isNew(prevProps, nextProps))\n      .forEach(name => {\n        dom.setAttribute(name,nextProps[name]);\n      });   \n\n    nextProps.style = nextProps.style || {};\n    Object.keys(nextProps.style)\n      .filter(isNew(prevProps.style, nextProps.style))\n      .forEach(key => {\n        dom.style[key] = nextProps.style[key];\n      });\n\n    Object.keys(nextProps)\n      .filter(isEvent)\n      .filter(isNew(prevProps, nextProps))\n      .forEach(name => {\n        const eventType = name.toLowerCase().substring(2);\n        dom.addEventListener(eventType, nextProps[name]);\n      });\n  }\n\n  function createElement(fiber) {\n    const isTextElement = fiber.tag === TEXT;\n    const dom = isTextElement\n      ? document.createTextNode('')\n      : document.createElement(fiber.tag);\n    updateProperties(dom, [], fiber.props);\n    return dom\n  }\n\n  let cursor = 0;\r\n\r\n  function update(k, r, v) {\r\n    r ? (v = r(this.state[k], v)) : v;\r\n    //这里实现不太理想，之后想办法搞成微任务\r\n    setTimeout(() => scheduleUpdate(this, k, v));\r\n  }\r\n  function resetCursor() {\r\n    cursor = 0;\r\n  }\r\n  function useState(initState) {\r\n    return useReducer(null, initState)\r\n  }\r\n  function useReducer(reducer, initState) {\r\n    let key = '$' + cursor;\r\n    let setter = update.bind(currentInstance, key, reducer);\r\n    if (currentInstance) cursor++;\r\n    let state;\r\n    if (currentInstance) state = currentInstance.state;\r\n    if (typeof state === 'object' && key in state) {\r\n      return [state[key], setter]\r\n    } else {\r\n      if (currentInstance) currentInstance.state[key] = initState;\r\n    }\r\n    let value = initState;\r\n    return [value, setter]\r\n  }\r\n\r\n  // 这个实现并不准确\r\n  function useEffect(effect, inputs) {\r\n    if (currentInstance) {\r\n      let key = '$' + cursor;\r\n      currentInstance.effects[key] = effect;\r\n      cursor++;\r\n    }\r\n  }\n\n  const HOST = 'host';\n  const HOOK = 'hook';\n  const ROOT = 'root';\n\n  const PLACE = 1;\n  const DELETE = 2;\n  const UPDATE = 3;\n\n  const ENOUGH_TIME = 1;\n\n  const updateQueue = [];\n  let nextUnitOfWork = null;\n  let pendingCommit = null;\n  let currentInstance = null;\n\n  function render(vdom, el) {\n    updateQueue.push({\n      from: ROOT,\n      dom: el,\n      newProps: { children: vdom }\n    });\n    requestIdleCallback(performWork);\n  }\n\n  function scheduleUpdate(instance, k, v) {\n    instance.state[k] = v;\n    updateQueue.push({\n      from: HOOK,\n      instance,\n      state: instance.state\n    });\n    requestIdleCallback(performWork);\n  }\n\n  function performWork(deadline) {\n    workLoop(deadline);\n    if (nextUnitOfWork || updateQueue.length > 0) {\n      requestIdleCallback(performWork);\n    }\n  }\n\n  function workLoop(deadline) {\n    if (!nextUnitOfWork) {\n      resetNextUnitOfWork();\n    }\n    while (nextUnitOfWork && deadline.timeRemaining() > ENOUGH_TIME) {\n      nextUnitOfWork = performUnitOfWork(nextUnitOfWork);\n    }\n    if (pendingCommit) {\n      commitAllWork(pendingCommit);\n    }\n    commitEffects(currentInstance.effects);\n  }\n\n  function commitEffects(effects) {\n    Object.keys(effects).forEach(key => {\n      let effect = effects[key];\n      effect();\n    });\n  }\n\n  function resetNextUnitOfWork() {\n    const update = updateQueue.shift();\n    if (!update) {\n      return\n    }\n\n    if (update.state) {\n      update.instance.__fiber.state = update.state;\n    }\n    const root =\n      update.from == ROOT\n        ? update.dom._rootContainerFiber\n        : getRoot(update.instance.__fiber);\n\n    nextUnitOfWork = {\n      type: ROOT,\n      base: update.dom || root.base,\n      props: update.newProps || root.props,\n      alternate: root\n    };\n  }\n\n  function getRoot(fiber) {\n    let node = fiber;\n    while (node.parent) {\n      node = node.parent;\n    }\n    return node\n  }\n\n  function performUnitOfWork(wipFiber) {\n    beginWork(wipFiber);\n    if (wipFiber.child) {\n      return wipFiber.child\n    }\n    let uow = wipFiber;\n    while (uow) {\n      completeWork(uow);\n      if (uow.sibling) {\n        return uow.sibling\n      }\n      uow = uow.parent;\n    }\n  }\n\n  function beginWork(wipFiber) {\n    if (wipFiber.type == HOOK) {\n      updateHOOKComponent(wipFiber);\n    } else {\n      updateHostComponent(wipFiber);\n    }\n  }\n\n  function updateHostComponent(wipFiber) {\n    if (!wipFiber.base) {\n      wipFiber.base = createElement(wipFiber);\n    }\n\n    const newChildren = wipFiber.props.children;\n    reconcileChildren(wipFiber, newChildren);\n  }\n\n  function updateHOOKComponent(wipFiber) {\n    let instance = wipFiber.base;\n    if (instance == null) {\n      instance = wipFiber.base = createInstance(wipFiber);\n    } else if (wipFiber.props == instance.props && !wipFiber.state) {\n      cloneChildFibers(wipFiber);\n    }\n    instance.props = wipFiber.props || {};\n    instance.state = wipFiber.state || {};\n    instance.effects = wipFiber.effects || {};\n    currentInstance = instance;\n    resetCursor();\n    const newChildren = wipFiber.tag(wipFiber.props);\n    reconcileChildren(wipFiber, newChildren);\n  }\n\n  function arrify(val) {\n    return val == null ? [] : Array.isArray(val) ? val : [val]\n  }\n\n  function reconcileChildren(wipFiber, newChildren) {\n    const elements = arrify(newChildren);\n\n    let index = 0;\n    let oldFiber = wipFiber.alternate ? wipFiber.alternate.child : null;\n    let newFiber = null;\n    while (index < elements.length || oldFiber != null) {\n      const prevFiber = newFiber;\n      const element = index < elements.length && elements[index];\n      const sameTag = oldFiber && element && element.tag == oldFiber.tag;\n\n      if (sameTag) {\n        newFiber = {\n          tag: oldFiber.tag,\n          type: oldFiber.type,\n          base: oldFiber.base,\n          props: element.props,\n          parent: wipFiber,\n          alternate: oldFiber,\n          state: oldFiber.state,\n          effectTag: UPDATE\n        };\n      }\n\n      if (element && !sameTag) {\n        newFiber = {\n          tag: element.tag,\n          type: typeof element.tag === 'string' ? HOST : HOOK,\n          props: element.props,\n          parent: wipFiber,\n          effectTag: PLACE\n        };\n      }\n\n      if (oldFiber && !sameTag) {\n        oldFiber.effectTag = DELETE;\n        wipFiber.effects = wipFiber.effects || [];\n        wipFiber.effects.push(oldFiber);\n      }\n\n      if (oldFiber) {\n        oldFiber = oldFiber.sibling;\n      }\n\n      if (index == 0) {\n        wipFiber.child = newFiber;\n      } else if (prevFiber && element) {\n        prevFiber.sibling = newFiber;\n      }\n\n      index++;\n    }\n  }\n\n  function createInstance(fiber) {\n    const instance = new fiber.tag(fiber.props);\n    instance.__fiber = fiber;\n    return instance\n  }\n\n  function cloneChildFibers(parentFiber) {\n    const oldFiber = parentFiber.alternate;\n    if (!oldFiber.child) {\n      return\n    }\n\n    let oldChild = oldFiber.child;\n    let prevChild = null;\n    while (oldChild) {\n      const newChild = {\n        tag: oldChild.tag,\n        type: oldChild.type,\n        base: oldChild.base,\n        props: oldChild.props,\n        state: oldChild.state,\n        alternate: oldChild,\n        parent: parentFiber\n      };\n      if (prevChild) {\n        prevChild.sibling = newChild;\n      } else {\n        parentFiber.child = newChild;\n      }\n      prevChild = newChild;\n      oldChild = oldChild.sibling;\n    }\n  }\n\n  function completeWork(fiber) {\n    if (fiber.type == HOOK) {\n      fiber.base.__fiber = fiber;\n    }\n\n    if (fiber.parent) {\n      const childEffects = fiber.effects || [];\n      const thisEffect = fiber.effectTag != null ? [fiber] : [];\n      const parentEffects = fiber.parent.effects || [];\n      fiber.parent.effects = parentEffects.concat(childEffects, thisEffect);\n    } else {\n      pendingCommit = fiber;\n    }\n  }\n\n  function commitAllWork(fiber) {\n    fiber.effects.forEach(f => {\n      commitWork(f);\n    });\n    fiber.base._rootContainerFiber = fiber;\n    nextUnitOfWork = null;\n    pendingCommit = null;\n  }\n\n  function commitWork(fiber) {\n    if (fiber.type == ROOT) {\n      return\n    }\n\n    let domParentFiber = fiber.parent;\n    while (domParentFiber.type == HOOK) {\n      domParentFiber = domParentFiber.parent;\n    }\n    const domParent = domParentFiber.base;\n\n    if (fiber.effectTag == PLACE && fiber.type == HOST) {\n      domParent.appendChild(fiber.base);\n    } else if (fiber.effectTag == UPDATE) {\n      updateProperties(fiber.base, fiber.alternate.props, fiber.props);\n    } else if (fiber.effectTag == DELETE) {\n      commitDELETE(fiber, domParent);\n    }\n  }\n\n  function commitDELETE(fiber, domParent) {\n    let node = fiber;\n    while (true) {\n      if (node.type == HOOK) {\n        node = node.child;\n        continue\n      }\n      domParent.removeChild(node.base);\n      while (node != fiber && !node.sibling) {\n        node = node.parent;\n      }\n      if (node == fiber) {\n        return\n      }\n      node = node.sibling;\n    }\n  }\n\n  exports.h = h;\n  exports.render = render;\n  exports.useState = useState;\n  exports.useReducer = useReducer;\n  exports.useEffect = useEffect;\n\n  Object.defineProperty(exports, '__esModule', { value: true });\n\n}));\n","import './style.css'\r\nimport { h, render } from 'fre'\r\n\r\nconst DOWN_URL = 'https://unpkg.com/@clicli/app'\r\nconst QCODE =\r\n  'https://ws1.sinaimg.cn/large/0065Zy9egy1g214spuj16j308c08c745.jpg'\r\n\r\nfunction App () {\r\n  return (\r\n    <div class='mainer'>\r\n      <div class='logo' />\r\n      <h1>人·生·就·是·佛</h1>\r\n      <ul class='link'>\r\n        <a href={DOWN_URL} target='_blank'>\r\n          <li>Android</li>\r\n        </a>\r\n        <a href=''>\r\n          <li>IOS</li>\r\n        </a>\r\n      </ul>\r\n      <div class='qcode'>\r\n        <img src={QCODE} alt='c站 app' />\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nrender(<App />, document.getElementById('root'))\r\n"]}